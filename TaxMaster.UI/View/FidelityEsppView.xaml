<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="TaxMaster.FidelityEsppView"
             xmlns:local="clr-namespace:TaxMaster"
             Title="FidelityEsppView">
    <ContentPage.BindingContext>
        <local:FidelityEsppViewModel />
    </ContentPage.BindingContext>
    <Grid RowDefinitions="9*, 1*">
        <ScrollView Grid.Row="0">
            <Grid RowDefinitions="10*, 5*, 5*" >
                <StackLayout Grid.Row="0" Padding="5">
                    <Label Margin="5" Text="בשלב זה נבצע חישוב על מניות ESPP שאתה מחזיק ב fidelity, אם אין לך מניות אנא דלג לשל הבא." HorizontalOptions="End" />
                    <Label Margin="5" Text="כל דוח מס מכיל ערך מס עבור הדיבדינטים שקיבלת השנה ובשלב זה נציג את הערך זה. בנוסף אם ביצעת מכירה של ESPP השנה עליך לצרף לדוח השני מסמך 1325 שמגיד את ערך הקנייה/מכירה ובו מחשוב את רווח או ההפדר ממכירת המנייה, בשלב זה נפיק את המסמך." HorizontalOptions="End" />
                    <Label Margin="5" Text="לשם הפקת המסמך עליך להשתמש במדריך המצורף ולהוריד שני קבצים האתר של fidelity, את קבצים אלו המערכת תקבל ותבצע את החישוב, לאחריו יוצגו התוצאות ואתצטרך לאשר אותן." HorizontalOptions="End" />
                    <ScrollView>
                        <WebView Source="{Binding EsppFidelityGuide}" HeightRequest="500" Margin="40,10,40,10" />
                    </ScrollView>
                </StackLayout>

                <StackLayout Grid.Row="1" Padding="5">
                    <Label Margin="5" Text="אנא טען את שני הקבצים:" HorizontalOptions="End" />
                    <StackLayout Orientation="Horizontal" FlowDirection="RightToLeft" Margin="10">
                        <Button Text="בחר את מסמך 1024s" Command="{Binding PickFileCommand}" VerticalOptions="Center" CommandParameter="1024"/>
                        <Label Text="{Binding Tax1024File}" Margin="5" HorizontalOptions="End" />
                        <Button Command="{Binding ResetFileCommand}"  CommandParameter="1024" IsVisible="{Binding Tax1024File, Converter={StaticResource StringToBooleanConverter}}">
                            <Button.ImageSource>
                                <FontImageSource Glyph="&#xE894;" FontFamily="Segoe Fluent Icons" Size="20" Color="Red" />
                            </Button.ImageSource>
                        </Button>
                    </StackLayout>
                    <StackLayout Orientation="Horizontal" FlowDirection="RightToLeft" Margin="10">
                        <Button Text="בחר את מסמך Custom Transaction Summary " Command="{Binding PickFileCommand}" CommandParameter="CustomTransactionSummary" />
                        <Label Text="{Binding CustomTransactionSummaryFile}" Margin="5" HorizontalOptions="End" VerticalOptions="Center" />
                        <Button Command="{Binding ResetFileCommand}"  CommandParameter="CustomTransactionSummary" IsVisible="{Binding CustomTransactionSummaryFile, Converter={StaticResource StringToBooleanConverter}}" >
                            <Button.ImageSource>
                                <FontImageSource Glyph="&#xE894;" FontFamily="Segoe Fluent Icons" Size="20" Color="Red" />
                            </Button.ImageSource>
                        </Button>
                    </StackLayout>
                    <Button Margin="10" Text="חשב" Command="{Binding CalcualteCommand}" HorizontalOptions="Center" VerticalOptions="Center" IsEnabled="{Binding IsCalculating, Converter={StaticResource InvertedBoolConverter}}"/>
                    <ActivityIndicator Margin="10" IsRunning="{Binding IsCalculating}" IsVisible="{Binding IsCalculating}" HorizontalOptions="Center" VerticalOptions="Center" />
                    <Label Text="{Binding CalcualteError}" Margin="5" HorizontalOptions="Center" VerticalOptions="Center" TextColor="Red" IsVisible="{Binding CalcualteError, Converter={StaticResource StringToBooleanConverter}}"/>
                </StackLayout>

                <StackLayout Grid.Row="2" Padding="5">
                    
                </StackLayout>
            </Grid>
        </ScrollView>
        <!-- Button area for navigation -->
        <Grid Grid.Row="1" Padding="10" ColumnDefinitions="2*,10*, 2*" FlowDirection="RightToLeft">
            <Button Text="הקודם" Command="{Binding PreviousCommand}" Grid.Column="0" IsVisible="{Binding IsPreviousEnabled}" CornerRadius="20" Padding="10,5" Margin="10" />
            <Button Text="הבא" Command="{Binding NextCommand}" Margin="10" Grid.Column="2" CornerRadius="20" Padding="10,5"/>
        </Grid>

    </Grid>
</ContentPage>